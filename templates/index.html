<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SA Loadshedding Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>South Africa Loadshedding Dashboard</h1>
            <div class="area-selector">
                <select id="areaDropdown">
                    <option value="national">National Overview</option>
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>
        </header>

        <div class="dashboard-grid">
            <!-- National/Area Status Card -->
            <div class="card status-card">
                <h2 id="scopeTitle">National Loadshedding Status</h2>
                <div class="status-indicator">
                    <span id="currentStage">Stage: Loading...</span>
                    <span id="nextStage">Next Stage: Loading...</span>
                </div>
                <div class="last-updated">Last updated: <span id="updatedTime">Loading...</span></div>
            </div>

            <!-- Loadshedding Stage Prediction -->
            <div class="card prediction-card">
                <h2>Loadshedding Prediction</h2>
                <div class="prediction-form">
                    <label for="predictionDays">Days ahead:</label>
                    <select id="predictionDays">
                        <option value="1">1 Day</option>
                        <option value="2">2 Days</option>
                        <option value="3">3 Days</option>
                        <option value="7">1 Week</option>
                    </select>
                    <button id="predictButton">Predict</button>
                </div>
                <div id="predictionResult" class="prediction-result">
                    <!-- Prediction will be inserted here -->
                </div>
            </div>

            <!-- Loadshedding Schedule Map -->
            <div class="card map-card">
                <h2>Loadshedding Hotspots</h2>
                <div id="map"></div>
            </div>

            <!-- Time Distribution Chart -->
            <div class="card chart-card">
                <h2>Loadshedding Time Distribution</h2>
                <canvas id="timeChart"></canvas>
            </div>

            <!-- Day of Week Distribution -->
            <div class="card chart-card">
                <h2>Day of Week Frequency</h2>
                <canvas id="dayChart"></canvas>
            </div>

            <!-- Stage Distribution -->
            <div class="card chart-card">
                <h2>Stage Occurrence</h2>
                <canvas id="stageChart"></canvas>
            </div>

            <!-- Duration Statistics -->
            <div class="card stats-card">
                <h2>Duration Statistics</h2>
                <div class="stat-item">
                    <span class="stat-label">Average Duration:</span>
                    <span class="stat-value" id="avgDuration">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Hours This Month:</span>
                    <span class="stat-value" id="totalHours">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Most Common Time:</span>
                    <span class="stat-value" id="commonTime">-</span>
                </div>
            </div>
<!-- Add to dashboard-grid -->
            <div class="card calendar-card">
                <h2>Loadshedding Calendar</h2>
                <div class="calendar-header">
                    <button id="prevMonth">&lt;</button>
                    <h3 id="currentMonth">Month Year</h3>
                    <button id="nextMonth">&gt;</button>
                </div>
                <div class="calendar-grid" id="calendar">
                    <!-- Calendar will be generated by JavaScript -->
                </div>
            </div>
            <div class="card calculator-card">
                <h2>Power Impact Calculator</h2>
                <div class="calculator-form">
                    <div class="appliance-input">
                        <select id="applianceSelect">
                            <option value="">Select Appliance</option>
                            <option value="fridge">Fridge (200W)</option>
                            <option value="tv">TV (150W)</option>
                            <option value="computer">Computer (300W)</option>
                            <option value="lights">Lights (100W)</option>
                            <option value="custom">Custom...</option>
                        </select>
                        <input type="number" id="customWatts" placeholder="Watts" style="display:none;">
                        <input type="number" id="hoursUsed" placeholder="Hours/day">
                        <button id="addAppliance">Add</button>
                    </div>
                    <div class="appliance-list" id="applianceList">
                        <!-- Appliance list will be populated here -->
                    </div>
                    <div class="calculator-results">
                        <h4>Estimated Impact:</h4>
                        <p>Daily Usage: <span id="dailyUsage">0</span> kWh</p>
                        <p>During Loadshedding: <span id="sheddingUsage">0</span> kWh</p>
                        <p>Battery Needed: <span id="batterySize">0</span> Ah (12V)</p>
                    </div>
                </div>
            </div>
            <div class="card notification-card">
                <h2>Get Loadshedding Alerts</h2>
                <form id="notificationForm">
                    <input type="email" id="notificationEmail" placeholder="Your email" required>
                    <select id="notificationArea" required>
                        <option value="">Select Area</option>
                    </select>
                    <select id="notificationStage">
                        <option value="all">All Stages</option>
                        <option value="1">Stage 1+</option>
                        <option value="2">Stage 2+</option>
                        <option value="3">Stage 3+</option>
                    </select>
                    <button type="submit">Subscribe</button>
                </form>
                <div id="notificationMessage"></div>
            </div>
            
        </div>
    </div>

    <script src="/static/js/scripts.js"></script>
</body>
</html>